Bootstrap: docker
From: pytorch/pytorch:1.12.0-cuda11.3-cudnn8-runtime

%files
    ./learned_parameters /
    ./lib/copy_all_models.py
    ./lib/trafficnn.py
    ./lib/gcn_dataset.py
    ./lib/gcn_model.py
    ./utils /
    ./detector.py /
    ./entrypoint.py /
    ./gcn_pipeline.def /
    ./metaparameters.json /
    ./metaparameters_schema.json /
    ./README.md /

%post
    apt update

    pip install --upgrade pip
    pip install opencv-python jsonschema jsonargparse jsonpickle
    pip install scikit-learn numpy pandas
    pip install tqdm
    pip install networkx
    pip install scipy
    pip install --no-index torch-scatter -f https://data.pyg.org/whl/torch-1.12.0+cu113.html
    pip install --no-index torch-sparse -f https://data.pyg.org/whl/torch-1.12.0+cu113.html
    pip install torch-geometric
    pip uninstall torch-spline-conv
    chmod 755 /*.py
    chmod -R 755 /utils

%runscript
    echo "Container was created $NOW"
    echo "Arguments received: $*"
    echo $PATH
    exec python3 /entrypoint.py "$@"

%labels
    Author UMBC
    Version v0.0.1

%help
    This is a GCN classifier container submitted by UMBC for Round 19.