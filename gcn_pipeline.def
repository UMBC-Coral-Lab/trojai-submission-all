Bootstrap: docker
From: python:3.8-bullseye

%files
    ./learned_parameters /
    ./lib/copy_all_models.py
    ./lib/gcn_dataset.py
    ./lib/gcn_model.py
    ./utils /
    ./detector.py /
    ./entrypoint.py /
    ./gcn_pipeline.def /
    ./gcn_pipeline.py /
    ./metaparameters.json /
    ./metaparameters_schema.json /
    ./README.md /
    ./run_gcn_model.py /

%post
    pip install --upgrade pip
    pip install pandas==1.3.5
    pip install torch --index-url https://download.pytorch.org/whl/cpu
    pip install trojai_rl
    pip install gym_minigrid==1.0.2
    pip install jsonschema jsonargparse jsonpickle scikit-learn==1.1.2
    pip install opencv-python
    pip install tqdm
    pip install networkx
    pip install scipy
    pip install torch-scatter -f https://data.pyg.org/whl/torch-1.12.0+cu113.html
    pip install torch-sparse -f https://data.pyg.org/whl/torch-1.12.0+cu113.html
    pip install torch-geometric
    pip uninstall torch-spline-conv
    chmod 755 /*.py
    chmod -R 755 /utils

%runscript
    echo "Container was created $NOW"
    echo "Arguments received: $*"
    echo $PATH
    exec python3 /entrypoint.py "$@"

%labels
    Author UMBC
    Version v0.0.1

%help
    This is a GCN classifier container submitted by UMBC for Round 14.
